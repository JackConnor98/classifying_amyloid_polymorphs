cat("Running: RMSD_analysis.R\n")
############################################################################################
# Installing and Loading Packages
required_packages <- c("dplyr", "stringr", "tidyr","readr", "ggplot2", "dendextend", "RColorBrewer", "tibble")
not_installed <- required_packages[!(required_packages %in% installed.packages()[ , "Package"])]
# Install missing packages
if(length(not_installed)) install.packages(not_installed)
# Load all required packages
invisible(lapply(required_packages, require, character.only = TRUE))
# Cleaning Environment
rm(list = ls())
output_dir <- file.path("Output", "RMSD")
data_path <- file.path("Output", "RMSD", "data")
single_pdb_dir <- file.path("Output", "RMSD", "single_reference")
# Creating Directories
if(!dir.exists(single_pdb_dir)) dir.create(single_pdb_dir)
############################################################################################
# Read in df
df <- read.csv(file.path(data_path, "pairwise_rmsd.csv"))
setwd("C:/Users/jpcon/OneDrive - University of Leeds/Leeds/classifying_amyloid_polymorphs")
output_dir <- file.path("Output", "RMSD")
data_path <- file.path("Output", "RMSD", "data")
single_pdb_dir <- file.path("Output", "RMSD", "single_reference")
# Creating Directories
if(!dir.exists(single_pdb_dir)) dir.create(single_pdb_dir)
############################################################################################
# Read in df
df <- read.csv(file.path(data_path, "pairwise_rmsd.csv"))
############################################################################################
### Removing Low Resolution Residues ###
# Importing data
high_resolution_residues <- read.csv("Output/Validation/high_resolution_residues.csv")
high_res_pdb_ids <- unique(high_resolution_residues$pdb_id)
filtered_df <- df %>% filter(ref_name %in% high_res_pdb_ids) %>%
filter((mob_name %in% high_res_pdb_ids))
############################################################################################
# Getting amyloid names from first chain only
amyloid_names <- unique(filtered_df$ref_name)
# Wide format data
df_wide <- pivot_wider(
filtered_df,
names_from = mob_name,
values_from = rmsd
)
names(df_wide)[names(df_wide) == "ref_name"] <- "pdb_id"
# Removing reference columns
cluster_data <- subset(df_wide, select = setdiff(names(df_wide), c("pdb_id")))
# Setting NA values to the mean + 3SD - This occurs when two PDBs have no overlapping residues
NA_distance <- mean(as.matrix(cluster_data), na.rm = TRUE) + 3*sd(as.matrix(cluster_data), na.rm = TRUE)
cluster_data[is.na(cluster_data)] <- NA_distance
# Scaling Cluster Data (makes mean of all columns = 0 and SD = 0-1)
scaled_cluster_data <- as.data.frame(scale(cluster_data))
View(scaled_cluster_data)
